\documentclass{article}

\usepackage{extramarks}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{listings}

\usepackage{hyperref}

\usepackage{tikz}

\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[shortlabels]{enumitem}

\usepackage{float,graphicx}

\usepackage{pgfplots}

\usepackage{adjustbox}


\usepackage{array}
\usepackage{pgfgantt}

\usepackage[utf8]{inputenc}

\usepackage{fancyhdr}
\usepackage{fancybox}

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

% Listings' Styles

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

\lstdefinestyle{python}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
 
\lstset{style=python}
\lstset{language=Python}

\linespread{1.1}
\captionsetup[table]{position=bottom}

\pagestyle{fancy}
\lhead{\groupName}
\chead{\hmwkClass: \hmwkTitle}
\rhead{\today}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}
\renewcommand\qedsymbol{$\blacksquare$}

\setlength\parindent{0pt}

\newcommand{\hmwkTitle}{Assignment Sheet\ \#\hmwkNumber}
\newcommand{\hmwkDueDate}{February 15, 2022}
\newcommand{\hmwkClass}{Machine Learning}
\newcommand{\hmwkAuthorName}{Henri Sota, Enis Mustafaj}
\newcommand{\groupName}{\textbf{Group HB}}

% Homework Number Variable
\newcommand{\hmwkNumber}{1}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
	\nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \stepcounter{#1}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}

\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Problem \hmwkNumber \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{homeworkProblemCounter}{\hmwkNumber.#1}
    \fi
    \section{Problem \hmwkNumber.\arabic{homeworkProblemCounter}}
    \setcounter{partCounter}{1}
    \enterProblemHeader{homeworkProblemCounter}
}{
    \exitProblemHeader{homeworkProblemCounter}
}


\newcounter{programmingPartCounter}
\newcounter{programmingProblemCounter}

\setcounter{programmingProblemCounter}{1}
\nobreak\extramarks{Programming Problem \hmwkNumber \arabic{programmingProblemCounter}}{}\nobreak{}

%
% Programming Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{programmingProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{programmingProblemCounter}{\hmwkNumber.#1}
    \fi
    \section{Programming Problem \hmwkNumber.\arabic{programmingProblemCounter}}
    \setcounter{programmingPartCounter}{1}
    \enterProblemHeader{programmingProblemCounter}
}{
    \exitProblemHeader{programmingProblemCounter}
}

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClass:\\ \hmwkTitle}}\\
    \normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate\ at 10:00}\\
    \vspace{3in}
}

\author{\groupName \\ \hmwkAuthorName}
\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}
\newcommand{\comment}[1]{} % Multi-line comment


\begin{document}
\maketitle
\pagebreak
\begin{homeworkProblem} 
The disjoint events $A$, $B$, and $C$ are defined in a sample space $\Omega$. Find expressions for the following probabilities in terms of sums of the probabilities $P(\emptyset)$, $P(A)$, $P(B)$, $P(A \cup B)$, $P(A \cup C)$, $P(B \cup C)$, $P(A \cup B \cup C)$:

\begin{enumerate}[a)]
    \item the probability that exactly  two of $A$, $B$, $C$ occur (\textit{at the same time!})
    \item the probability that exactly one of these events occurs
\end{enumerate}
\end{homeworkProblem}

\begin{homeworkProblem}
We consider the chance experiment of four tosses of a fair coin.

\begin{enumerate}[a)]
    \item Give the sample space $\Omega$ for this experiment and define a discrete random variable $X$ to describe the number of heads obained in four tosses of a fair coin.
    \item Find the PMF and CDF of the defined random variable and plot the CDF.
    \item Compute the probability of the event $X$ IS BIGGER THAN $1$.
    \item Compute the mean of the random variable.
\end{enumerate}
\end{homeworkProblem}

\begin{homeworkProblem}
Let the function $\rho$ with $\rho(x) = 
\begin{cases}
    c|x| (1 + x)(1 - x) & \text{if } -1 \leq x \leq 1\\
    0 & \text{else}
\end{cases}$
be given.

\begin{enumerate}[a)]
    \item Compute the constant $c$, such that $\rho$ becomes a density of some random variable.
    
    For $\rho$ to become a density of some random variable, the function must fulfill the requirement that the integral over the domain should equal to $1$.
    
    \begin{equation*}
        \begin{split}
            \int_{-\infty}^{\infty} \rho(x) \: dx & = \int_{-\infty}^{\infty} c |x| (1 + x)(1 - x) \: dx \\
            & = \int_{-1}^{1} c |x| (1 + x)(1 - x) \: dx \\
            & = -\int_{-1}^{0} c x (1 + x)(1 - x) \: dx + \int_{0}^{1} c x (1 + x)(1 - x) \: dx \\
            & = c \left( -\int_{-1}^{0} x(1 + x)(1 - x) \: dx + \int_{0}^{1} x(1 + x)(1 - x) \: dx \right)
        \end{split}
    \end{equation*}
    
    To solve the inner integrals, we use the substitution $u = (1 + x)(1 - x)$:
    
    \begin{equation*}
        \begin{split}
            \int x(1 + x)(1 - x) \: dx & = -\frac{1}{2} \int u \: du \\
            & = - \frac{u^{2}}{4} + C \\
            & = - \frac{(1 + x)^{2} (1 - x)^{2}}{4} + C
        \end{split}
    \end{equation*}
    
    Using the result of the integral to find the value of $c$:
    
    \begin{equation*}
        \begin{split}
            \int_{-\infty}^{\infty} \rho(x) \: dx & = c \left( -\int_{-1}^{0} x(1 + x)(1 - x) \: dx + \int_{0}^{1} x(1 + x)(1 - x) \: dx \right) \\
            & = c \left( -\left[ - \frac{(1 + x)^{2} (1 - x)^{2}}{4} \right]_{-1}^{0} + \left[ - \frac{(1 + x)^{2} (1 - x)^{2}}{4} \right]_{0}^{1} \right) \\
            & = c \left( \frac{1}{4} + \frac{1}{4} \right) \\
            & = \frac{c}{2}
        \end{split}
    \end{equation*}
    
    Equating this result to 1, gives the value of $c$ to be $2$.
    \item Consider a random variable $X$ with the just computed density $\rho$. Find its CDF and plot it.
    
    To find the CDF of the random variable $X$, one can use the property that the derivative of the CDF is the density function. Combining this with the boundaries of the range of the CDF, the CDF can be calculated in the following way:
    
    \begin{equation*}
        F_{X}(x) = \begin{cases}
            0 & x < -1 \\
            \int_{-\infty}^{x} \rho(x) \: dx & -1 \leq x \leq 1 \\
            1 & x > 1
        \end{cases}
    \end{equation*}
    
    \begin{equation*}
        \begin{split}
            \int \rho(x) \: dx & = \int 2 |x| (1 + x)(1 - x) \: dx \\
            & = 2 \frac{x}{|x|} \int \frac{|x|}{x} |x| (1 + x)(1 - x) \: dx \\
            & = 2 \frac{x}{|x|} \int x(1 + x)(1 - x) \: dx \\
            & = -2 \frac{x}{|x|} \frac{x^{4} - 2x^{2}}{4} + C \\
            & = - \frac{x(x^4 - 2x^{2})}{2|x|} + C
        \end{split}
    \end{equation*}
    
    Using the boundary definitions, the value of the constant is $\frac{1}{2}$. We arrive at the definition of the CDF and its plot:

    \begin{equation*}
        F_{X}(x) = \begin{cases}
            0 & x < -1 \\
            - \frac{x(x^4 - 2x^{2})}{2|x|} + \frac{1}{2} & -1 \leq x \leq 1 \\
            1 & x > 1
        \end{cases}
    \end{equation*}
    
    \begin{center}
        \begin{tikzpicture}[
              declare function={
                func(\x)= (\x < -1) * (0) +
                          and(\x >= -1, \x <= 1) * (-((\x * (\x * \x * \x * \x - 2 * \x * \x))/(2 * abs(\x))) + 0.5) +
                          (\x > 1) * (1)
               ;
              }
            ]
            \begin{axis}[
              axis x line=middle, axis y line=middle,
              ymin=-0.5, ymax=1.5, ytick={-1.5,-1.0,...,1.0,1.5}, ylabel=$y$,
              xmin=-1.5, xmax=1.5, xtick={-1.5,-1.0,...,1.0,1.5}, xlabel=$x$,
              domain=-1.2:1.2,samples=500, % added
            ]
            
            \addplot [blue,thick] {func(x)};
            \end{axis}
        \end{tikzpicture} 
    \end{center}

    
    \item Use the CDF to compute \begin{equation*}
        P(X < -0.5), \quad P(X > 0.5), \quad P(-0.5 < X < 0.5)
    \end{equation*}
    
    \begin{equation*}
        \begin{split}
            P(X < -0.5) = F(-0.5) - P(X = -0.5) = F(-0.5) = \frac{9}{32} = 0.28125
        \end{split}
    \end{equation*}
    
    \begin{equation*}
        \begin{split}
            P(X > 0.5) = 1 - P(X <= 0.5) = 1 - F(0.5) = 1 - \frac{23}{32} = 1 - 0.71875 = 0.28125
        \end{split}
    \end{equation*}
    
    \begin{equation*}
        \begin{split}
            P(-0.5 < X < 0.5) = F(0.5) - P(X = 0.5) - F(-0.5) = F(0.5) - F(-0.5) = 0.71875 - 0.28125 - 0.4375
        \end{split}
    \end{equation*}
\end{enumerate}
\end{homeworkProblem}

\begin{programmingProblem}
In this first programming exercise, we would like to familiarize us with typical linear algebra computing tasks. To this end, we define the vectors / matrices

\begin{equation*}
    \mathbf{a} = \begin{pmatrix} 1 \\ 1 \\ 0 \end{pmatrix}, \quad
    \mathbf{b} = \begin{pmatrix} -1 \\ 2 \\ 5 \end{pmatrix}, \quad
    M = \begin{pmatrix} 2 & -1 & 0 \\ -1 & 2 & -1 \\ 0 & -1 & 2 \end{pmatrix}
\end{equation*}

\begin{enumerate}[a)]
    \item Compute and print the inner product between $\mathbf{a}$ and $\mathbf{b}$.
\begin{lstlisting}
np.dot(a.T, b)
\end{lstlisting}
    \item Compute and print the matrix-vector product between $M$ and $\mathbf{b}$.
\begin{lstlisting}
M.dot(b)
\end{lstlisting}
    \item Compute and print the $l_{2}$ norm of $\mathbf{b}$.
\begin{lstlisting}
np.linalg.norm(b)
\end{lstlisting}
    \item Compute and print the solution $\mathbf{x}$ of the linear system of equations $M \mathbf{x} = \mathbf{b}$ using the LU factorization.
\begin{lstlisting}
np.linalg.solve(M, b)
\end{lstlisting}
    \item Compute and print the solution $\mathbf{x}$ of the linear system of equations $M \mathbf{x} = \mathbf{b}$ using the Cholesky factorization.
\begin{lstlisting}
L = np.linalg.cholesky(M)
y = np.linalg.solve(L, b)
x = np.linalg.solve(L.T.conj(), y)
\end{lstlisting}
    
    The solutions to these exercises are in \lstinline!programming_exercises.py!.
\end{enumerate}
\end{programmingProblem}

\end{document}
