\documentclass{article}

\usepackage{extramarks}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{listings}

\usepackage{hyperref}

\usepackage{tikz}

\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[shortlabels]{enumitem}

\usepackage{float,graphicx}

\usepackage{pgfplots}

\usepackage{adjustbox}


\usepackage{array}
\usepackage{pgfgantt}

\usepackage[utf8]{inputenc}

\usepackage{fancyhdr}
\usepackage{fancybox}


\usepackage{algorithm}
\usepackage{algorithmic}

\usepackage{algpseudocode}



\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

% Listings' Styles

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}


\lstdefinestyle{python}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}

\lstset{style=python}
\lstset{language=Python}

\linespread{1.1}
\captionsetup[table]{position=bottom}

\pagestyle{fancy}
\lhead{\groupName}
\chead{\hmwkClass: \hmwkTitle}
\rhead{\today}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}
\renewcommand\qedsymbol{$\blacksquare$}

\setlength\parindent{0pt}

\newcommand{\hmwkTitle}{Assignment Sheet\ \#\hmwkNumber}
\newcommand{\hmwkDueDate}{April 26, 2022}
\newcommand{\hmwkClass}{Machine Learning}
\newcommand{\hmwkAuthorName}{Henri Sota, Enis Mustafaj}
\newcommand{\groupName}{\textbf{Group HB}}

% Homework Number Variable
\newcommand{\hmwkNumber}{10}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
    \nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \stepcounter{#1}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}

\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Problem \hmwkNumber \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{homeworkProblemCounter}{\hmwkNumber.#1}
    \fi
    \section{Problem \hmwkNumber.\arabic{homeworkProblemCounter}}
    \setcounter{partCounter}{1}
    \enterProblemHeader{homeworkProblemCounter}
}{
    \exitProblemHeader{homeworkProblemCounter}
}


\newcounter{programmingPartCounter}
\newcounter{programmingProblemCounter}

\setcounter{programmingProblemCounter}{1}
\nobreak\extramarks{Programming Problem \hmwkNumber \arabic{programmingProblemCounter}}{}\nobreak{}

%
% Programming Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{programmingProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{programmingProblemCounter}{\hmwkNumber.#1}
    \fi
    \section{Programming Problem \hmwkNumber.\arabic{programmingProblemCounter}}
    \setcounter{programmingPartCounter}{1}
    \enterProblemHeader{programmingProblemCounter}
}{
    \exitProblemHeader{programmingProblemCounter}
}

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClass:\\ \hmwkTitle}}\\
    \normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate\ at 10:00}\\
    \vspace{3in}
}

\author{\groupName \\ \hmwkAuthorName}
\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}
\newcommand{\comment}[1]{} % Multi-line comment

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\begin{document}
\maketitle
\pagebreak
\begin{homeworkProblem}
In this task, you carry out $K$-means clustering with $K = 3$ by paper and pencil. To this end, you are given the following data
\begin{table}[h!]
    \centering
    \begin{tabular}{c|c|c}
    $i$ & $x_{i}$ & $C^{(0)}(i)$ \\ \hline
    1 & $(15, 7)^{\top}$ & 2 \\
    2 & $(0, -9)^{\top}$ & 1 \\
    3 & $(-2, -5)^{\top}$ & 1 \\
    4 & $(2, 3)^{\top}$ & 0 \\
    5 & $(3, 7)^{\top}$ & 2 \\
    6 & $(18, 12)^{\top}$ & 0
    \end{tabular}
\end{table}

with its initial cluster assignment. Let the clustering algorithm "run" until it finalized its assignment. Finally, draw the just computed clusters in a two-dimensional scatter plot.
\end{homeworkProblem}

\begin{homeworkProblem}
You are given the data set
\begin{equation*}
    \{ (3, 2)^{\top}, (-1, 0)^{\top}, (7, 1)^{\top} \}
\end{equation*}

\textit{Manually} compute the principle components of this data set by solving the associated eigenvalue problem.
\end{homeworkProblem}

\begin{homeworkProblem}
A well-known application of principle component analysis is lossy data compression. In this application, you are given a large data set $\{ \mathbf{x} \}_{i = 1}^{N}$ with $\mathbf{x}_{i} \in \mathbb{R}^{D}$ and reduce it to a data set $\{ \bar{\mathbf{x}} \}_{i = 1}^{N}$ with $\bar{\mathbf{x}}_{i} \in \mathbb{R}^{d}$ where $d < D$, while storing a matrix that allows to reconstruct an approximation to the $\mathbf{x}_{i}$ from the vectors $\bar{\mathbf{x}}_{i}$.

Develop and give a compression and a decompression algorithm which carry out the above described data compression and decompression tasks by using principle component analysis. You can either try to develop the idea by yourself or do a research in the internet. In the latter case, please quote the source from which you took the information.

The followings are the algorithms to compress and decompress a set of data $\{ \mathbf{x} \}_{i = 1}^{N}$:


\begin{algorithm}[H]
\caption{Data Compression}
\begin{algorithmic} 
\Procedure{Compress}{data, nr\_components}
    \STATE $Mean \leftarrow mean(data)$
    \STATE $Zero\_Centered \leftarrow data - Mean x$
    \STATE $Cov\_Matrix \leftarrow (Zero\_Centered^{T} \cdot Zero\_Centered) / (length(data) - 1)$
    \STATE $eig\_values, eig\_vectors \leftarrow eig(Cov\_Matrix)$
    \STATE $selected\_components \leftarrow eig\_vectors[:, :nr\_components]$
    \STATE $compressed\_data \leftarrow selected\_components^{T} \cdot data^{T}$
    \RETURN $compressed\_data^{T}$
\EndProcedure
\end{algorithmic}
\end{algorithm}


\begin{algorithm}[H]
\caption{Data Decompression}
\begin{algorithmic} 
\Procedure{Decompress}{compressed\_data, selected\_components}
    \STATE $decompressed\_data \leftarrow compressed\_data \cdot selected\_components^{T}$
    \RETURN $decompressed\_data$
\EndProcedure
\end{algorithmic}
\end{algorithm}


\end{homeworkProblem}


\begin{programmingProblem}
In this task, you are supposed to apply your just developed data compression algorithm to the MNIST data set. To this end, consult again Example 9.4, which provides access to the hand-written digits for the value 8 in MNIST. Compress the images of these digits to a dimensionality of $d = 784, 512, 256, 128, 64, 32$, decompress them again, and plot the decompressed digits.

The implementation of the above algorithms can be found in the file \texttt{programming\_exercises.ipynb}.
\end{programmingProblem}
\end{document}