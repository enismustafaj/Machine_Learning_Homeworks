\documentclass{article}

\usepackage{extramarks}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{listings}

\usepackage{hyperref}

\usepackage{tikz}

\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage[shortlabels]{enumitem}

\usepackage{float,graphicx}

\usepackage{pgfplots}

\usepackage{adjustbox}


\usepackage{array}
\usepackage{pgfgantt}

\usepackage[utf8]{inputenc}

\usepackage{fancyhdr}
\usepackage{fancybox}

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

% Listings' Styles

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}


\lstdefinestyle{python}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
 
\lstset{style=python}
\lstset{language=Python}

\linespread{1.1}
\captionsetup[table]{position=bottom}

\pagestyle{fancy}
\lhead{\groupName}
\chead{\hmwkClass: \hmwkTitle}
\rhead{\today}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}
\renewcommand\qedsymbol{$\blacksquare$}

\setlength\parindent{0pt}

\newcommand{\hmwkTitle}{Assignment Sheet\ \#\hmwkNumber}
\newcommand{\hmwkDueDate}{February 15, 2022}
\newcommand{\hmwkClass}{Machine Learning}
\newcommand{\hmwkAuthorName}{Henri Sota, Enis Mustafaj}
\newcommand{\groupName}{\textbf{Group HB}}

% Homework Number Variable
\newcommand{\hmwkNumber}{2}

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
    \nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \stepcounter{#1}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}

\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Problem \hmwkNumber \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{homeworkProblemCounter}{\hmwkNumber.#1}
    \fi
    \section{Problem \hmwkNumber.\arabic{homeworkProblemCounter}}
    \setcounter{partCounter}{1}
    \enterProblemHeader{homeworkProblemCounter}
}{
    \exitProblemHeader{homeworkProblemCounter}
}


\newcounter{programmingPartCounter}
\newcounter{programmingProblemCounter}

\setcounter{programmingProblemCounter}{1}
\nobreak\extramarks{Programming Problem \hmwkNumber \arabic{programmingProblemCounter}}{}\nobreak{}

%
% Programming Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{programmingProblem}[1][-1]{
    \ifnum#1>0
        \setcounter{programmingProblemCounter}{\hmwkNumber.#1}
    \fi
    \section{Programming Problem \hmwkNumber.\arabic{programmingProblemCounter}}
    \setcounter{programmingPartCounter}{1}
    \enterProblemHeader{programmingProblemCounter}
}{
    \exitProblemHeader{programmingProblemCounter}
}

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClass:\\ \hmwkTitle}}\\
    \normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate\ at 10:00}\\
    \vspace{3in}
}

\author{\groupName \\ \hmwkAuthorName}
\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}
\newcommand{\comment}[1]{} % Multi-line comment


\begin{document}
\maketitle
\pagebreak
\begin{homeworkProblem} 
We consider the chance experiment of a fair coin that is tossed four times.

\begin{enumerate}[a)]
    \item Give the sample space.
    
    The sample space is: 
        \begin{multline*}
            \Omega = \{(HHHH), (HHHT), (HHTH), (HTHH), (THHH), (HHTT), (HTHT), (THHT),  \\
            (THTH), (TTHH), (HTTH), (HTTT), (THTT), (TTHT), (TTTH), (TTTT)\}
        \end{multline*}

    \item Define the random variable $X$ to be the number of heads, $Y$ as the number of tails and $Z$ as $Z = |X -Y|$.
        Random variables X, Y, Z are defined as following:
        \begin{align*}
            X(TTTT) &= 0, & X(TTTH) &= 1, & X(TTHT) &= 1, & X(THTT) &= 1 \\
            X(HTTT) &= 1, & X(HHTT) &= 2, & X(HTHT) &= 2, & X(THHT) &= 2 \\
            X(THTH) &= 2, & X(TTHH) &= 2, & X(HTTH) &= 2, & X(HHHT) &= 3 \\
            X(HHTH) &= 3, & X(HTHH) &= 3, & X(THHH) &= 3, & X(HHHH) &= 4
        \end{align*}
        \begin{align*}
            Y(TTTT) &= 4, & Y(TTTH) &= 3, & Y(TTHT) &= 3, & Y(THTT) &= 3 \\
            Y(HTTT) &= 3, & Y(HHTT) &= 2, & Y(HTHT) &= 2, & Y(THHT) &= 2 \\
            Y(THTH) &= 2, & Y(TTHH) &= 2, & Y(HTTH) &= 2, & Y(HHHT) &= 1 \\
            Y(HHTH) &= 1, & Y(HTHH) &= 1, & Y(THHH) &= 1, & Y(HHHH) &= 0
        \end{align*}
        \begin{align*}
            Z(TTTT) &= 4, & Z(TTTH) &= 2, & Z(TTHT) &= 2, & Z(THTT) &= 2 \\
            Z(HTTT) &= 2, & Z(HHTT) &= 0, & Z(HTHT) &= 0, & Z(THHT) &= 0 \\
            Z(THTH) &= 0, & Z(TTHH) &= 0, & Z(HTTH) &= 0, & Z(HHHT) &= 2 \\
            Z(HHTH) &= 2, & Z(HTHH) &= 2, & Z(THHH) &= 2, & Z(HHHH) &= 4
        \end{align*}

    
    \item Compute the joint PMF of $(X, Z)$. \\
        The PMF of variables X and Z is is defined as following: 
            \begin{equation*}
                p(0, 4) = p(\{(TTTT)\} \cap \{(TTTT), (HHHH)\}) = p(\{(TTTT)\}) = \frac{1}{16}
            \end{equation*}
            \begin{multline*}
                p(1, 1) = p(\{(TTTH), (TTHT), (THTT), (HTTT)\} \cap \{(TTTH), (TTHT),  (THTT),\\ (HTTT), (HHHT), (HHTH), (HTHH), (THHH)\}) = p(\{(TTTH), (TTHT), (THTT), (HTTT)\}) = \frac{1}{4}
            \end{multline*}
    
            \begin{multline*}
                p(2, 0) = p(\{(HHTT), (HTHT), (THHT), (THTH), (TTHH), (HTTH)\} \cap \{(HHTT), (HTHT),  (THHT),\\ (THTH), (TTHH), (HTTH)\}) = p(\{(HHTT), (HTHT), (THHT), (THTH), (TTHH), (HTTH)\}) = \frac{3}{8}
            \end{multline*}
            \begin{multline*}
                p(3, 1) = p(\{(HHHT), (HHTH), (HTHH), (THHH)\} \cap \{(TTTH), (TTHT),  (THTT),\\ (HTTT), (HHHT), (HHTH), (HTHH), (THHH)\}) = p(\{(HHHT), (HHTH), (HTHH), (THHH)\}) = \frac{1}{4}
            \end{multline*}
            \begin{equation*}
                p(4, 4) = p(\{(HHHH)\} \cap \{(TTTT), (HHHH)\}) = p(\{(HHHH)\}) = \frac{1}{16}
            \end{equation*}
            
        PMF for the other values of X and Z is $p(X, Z) = P( \emptyset ) = 0$
 
    \item Compute the expectation $E(Y)$.
        The expectation $E(Y)$ is computed as following:
            \begin{equation*}
                E(Y) = \sum_{y \in R_{y}} y \cdot P(Y = y) = 0 \cdot \frac{1}{16} + 1 \cdot \frac{1}{4} + 2 \cdot \frac{5}{16} + 3 \cdot \frac{4}{16} + 4 \cdot \frac{1}{16} = \frac{30}{16} = 1.875 
            \end{equation*}
    
\end{enumerate}
\end{homeworkProblem}

\begin{homeworkProblem}
We consider the chance experiment of a fair dice that is rolled two times. Let $X_{1}$ be the outcome of the first roll, while $X_{2}$ is the outcome of the second roll.

\begin{enumerate}[a)]
    \item Describe the chance experiment by its sample space, and define the random variables.
    
    The sample space is:
    \begin{equation*}
        \begin{split}
            \Omega = \{11, 12, 13, 14, 15, 16 \
                        21, 22, 23, 24, 25, 26 \
                        31, 32, 33, 34, 35, 36 \ \\
                        41, 42, 43, 44, 45, 46 \
                        51, 52, 53, 54, 55, 56 \
                        61, 62, 63, 64, 65, 66 \}
        \end{split}
    \end{equation*}

Definition of $X_{1}$

\begin{table}[h!]
\centering
\begin{tabular}{cccccc}
$X_{1}(11) = 1$ & $X_{1}(12) = 1 $ & $X_{1}(13) = 1 $ & $X_{1}(14) = 1 $ & $X_{1}(15) = 1 $ & $X_{1}(16) = 1$  \\
$X_{1}(21) = 2$ & $X_{1}(22) = 2 $ & $X_{1}(23) = 2 $ & $X_{1}(24) = 2 $ & $X_{1}(25) = 2 $ & $X_{1}(26) = 2$  \\
$X_{1}(31) = 3$ & $X_{1}(32) = 3 $ & $X_{1}(33) = 3 $ & $X_{1}(34) = 3 $ & $X_{1}(35) = 3 $ & $X_{1}(36) = 3$  \\
$X_{1}(41) = 4$ & $X_{1}(42) = 4 $ & $X_{1}(43) = 4 $ & $X_{1}(44) = 4 $ & $X_{1}(45) = 4 $ & $X_{1}(46) = 4$  \\
$X_{1}(51) = 5$ & $X_{1}(52) = 5 $ & $X_{1}(53) = 5 $ & $X_{1}(54) = 5 $ & $X_{1}(55) = 5 $ & $X_{1}(56) = 5$  \\
$X_{1}(61) = 6$ & $X_{1}(62) = 6 $ & $X_{1}(63) = 6 $ & $X_{1}(64) = 6 $ & $X_{1}(65) = 6 $ & $X_{1}(66) = 6$
\end{tabular}
\end{table}

Definition of $X_{2}$

\begin{table}[h!]
\centering
\begin{tabular}{cccccc}
$X_{2}(11) = 1$ & $X_{2}(12) = 2 $ & $X_{2}(13) = 3 $ & $X_{2}(14) = 4 $ & $X_{2}(15) = 5 $ & $X_{2}(16) = 6$  \\
$X_{2}(21) = 1$ & $X_{2}(22) = 2 $ & $X_{2}(23) = 3 $ & $X_{2}(24) = 4 $ & $X_{2}(25) = 5 $ & $X_{2}(26) = 6$  \\
$X_{2}(31) = 1$ & $X_{2}(32) = 2 $ & $X_{2}(33) = 3 $ & $X_{2}(34) = 4 $ & $X_{2}(35) = 5 $ & $X_{2}(36) = 6$  \\
$X_{2}(41) = 1$ & $X_{2}(42) = 2 $ & $X_{2}(43) = 3 $ & $X_{2}(44) = 4 $ & $X_{2}(45) = 5 $ & $X_{2}(46) = 6$  \\
$X_{2}(51) = 1$ & $X_{2}(52) = 2 $ & $X_{2}(53) = 3 $ & $X_{2}(54) = 4 $ & $X_{2}(55) = 5 $ & $X_{2}(56) = 6$  \\
$X_{2}(61) = 1$ & $X_{2}(62) = 2 $ & $X_{2}(63) = 3 $ & $X_{2}(64) = 4 $ & $X_{2}(65) = 5 $ & $X_{2}(66) = 6$ 
\end{tabular}
\end{table}
    
    \item Compute the conditional expectation $E[X_{1}  X_{2} | X_{2} = x_{2}]$.
    
\begin{equation*}
    \begin{split}
        E[X_{1} + X_{2} | X_{2} = x_{2}] & = E[X_{1} | X_{2} = x_{2}] + E[X_{2} | X_{2} = x_{2}] \\
        & = E[X_{1}] + x_{2} \\
        & = 3.5 + x_{2}
    \end{split}
\end{equation*}

$E[X_{1} | X_{2} = x_{2}] = E[X_{1}]$ holds due to the independence between the two variables (they refer to two different rolls of the fair dice)
    
    \item Compute the conditional expectation $E[X_{1}X_{2} | X_{2} = x_{2}]$.
    
\begin{equation*}
    \begin{split}
        E[X_{1}X_{2} | X_{2} = x_{2}] & = x_{2} E[X_{1} | X_{2} = x_{2}] \\
        & = x_{2} E[X_{1}] \\
        & = 3.5 \cdot x_{2}
    \end{split}
\end{equation*}

$E[X_{1} | X_{2} = x_{2}] = E[X_{1}]$ holds due to the independence between the two variables (they refer to two different rolls of the fair dice)
    
    \item Compute the conditional variance Var$(X_{1}^{2}X_{2} | X_{2} = x_{2})$.
    
By definition of variance, it can computed as:
\begin{equation*}
\setlength{\jot}{10pt}
\begin{split}
    \text{Var}(X_{1}^{2}X_{2} | X_{2} = x_{2}) & = E[(X_{1}^{2}X_{2} - E[X_{1}^{2}X_{2} | X_{2} = x_{2}])^{2} | X_{2} = x_{2}] \\ & = E \left[  X_{1}^{4} X_{2}^{2} - 2 X_{1}^{2} X_{2} E[X_{1}^{2} X_{2} | X_{2} = x_{2}] + E[X_{1}^{2} X_{2} | X_{2} = x_{2}]^{2} | X_{2} = x_{2} \right] \\
    & = x_{2}^{2} E[X_{1}^{4} | X_{2} = x_{2}] - 2 E[X_{1}^{2} X_{2} x_{2} E[X_{1}^{2} | X_{2} = x_{2}] | X_{2} = x_{2}] \\ & \ \ \ + E[x_{2}^{2} E[X_{1}^{2} | X_{2} = x_{2}]^{2} | X_{2} = x_{2}] \\
    & = x_{2}^{2} E[X_{1}^{4}] - 2 E[X_{1}^{2} X_{2} x_{2} E[X_{1}^{2}] | X_{2} = x_{2}] + E[x_{2}^{2} E[X_{1}^{2}]^{2} | X_{2} = x_{2}] \\
    & = x_{2}^{2} E[X_{1}^{4}] - 2 x_{2}^{2} E[X_{1}^{2} E[X_{1}^{2}]] + x_{2}^{2} E[E[X_{1}^{2}]^{2}] \\
    & = x_{2}^{2} E[X_{1}^{4}] - 2 x_{2}^{2} E[X_{1}^{2}] E[X_{1}^{2}] + x_{2}^{2} E[X_{1}^{2}]^{2} \\
\end{split}
\end{equation*}

Substituting the expected values for $X_{1}^{4}$ and $X_{1}^{2}$

\begin{equation*}
    E_[X_{1}^{2}] = \frac{91}{6} \quad E[X_{1}^{4}] = \frac{2275}{6} 
\end{equation*}

\begin{equation*}
\setlength{\jot}{10pt}
\begin{split}
\text{Var}(X_{1}^{2}X_{2} | X_{2} & = x_{2}^{2} E[X_{1}^{4}] - 2 x_{2}^{2} E[X_{1}^{2}] E[X_{1}^{2}] + x_{2}^{2} E[X_{1}^{2}] \\
& = x_{2}^{2} \left ( \frac{2275}{6} - 2 \frac{91}{6} \frac{91}{6} + \left( \frac{91}{6} \right)^{2} \right ) \\
    & = x_{2}^{2} \frac{2275 \cdot 6 - 91^{2}}{36} \\
    & = x_{2}^{2} \frac{5369}{36} \\
    & \approx 149.14 \cdot x_{2}^{2}
\end{split}
\end{equation*}
    
\end{enumerate}
\end{homeworkProblem}

\begin{homeworkProblem}
Let $(X, Y)$ be random variables describing the two coordinates of points that are uniformly distributed in a triangle that is bound $-1 \leq x \leq 1, y \geq 0$ and the two lines $y = 1 + x$ and $y = 1 - x$.

\begin{enumerate}[a)]
    \item Find $P(X \geq -0.5)$.
    \item Find $P(Y \geq 0.5)$.
    \item Find the marginal densities and expectations of $X$ and $Y$.
\end{enumerate}
\end{homeworkProblem}

\begin{programmingProblem}
\begin{enumerate}[a)]
    \item Generate a random set of two-dimensional points and plot them as a scatter plot.
    
    \begin{lstlisting}
size = 100
points = np.random.rand(size, 2)
    
fig = plt.figure()
ax = fig.add_subplot(1, 1, 1)

ax.scatter(points[:, 0], points[:, 1])
plt.show()\end{lstlisting}
    \item Plot the density of the 2D Gaussian distribution $\mathcal{N}(\mu, \mathbf{\Sigma})$ with $\mu = \begin{pmatrix}0 \\ 1\end{pmatrix}$ and $\mathbf{\Sigma} = \begin{pmatrix} 1 & 0.25 \\ 0.25 & 1\end{pmatrix}$.
    
    \begin{lstlisting}
def two_dimensional_gaussian(mean, cov, pos):
    cov_det = np.linalg.det(cov)
    cov_inv = np.linalg.inv(cov)
    
    N = np.sqrt((2 * np.pi) ** 2 * cov_det)
    
    fac = np.einsum('...k,kl,...l->...', pos - mean, cov_inv, pos - mean)

    return np.exp(-fac / 2) / N

sample = 100

X = np.linspace(-3, 3, sample)
Y = np.linspace(-2, 4, sample)
X, Y = np.meshgrid(X, Y)

pos = np.empty(X.shape + (2,))
pos[:, :, 0] = X
pos[:, :, 1] = Y

mean = np.array([0, 1])
cov = np.array([[1, 0.25], [0.25, 1]])

dst = two_dimensional_gaussian(mean, cov, pos)

fig = plt.figure(figsize=(15, 15))
ax = fig.add_subplot(projection='3d')

ax.plot_surface(X, Y, dst, linewidth=1, cmap=cm.jet)

ax.set_zlim(-0.05, 0.2)
ax.set_zticks(np.linspace(0, 0.2, 5))
ax.view_init(20, -20)

plt.show()\end{lstlisting}
\end{enumerate}
\end{programmingProblem}

\end{document}
